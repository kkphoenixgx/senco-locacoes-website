<div class="card-container" [class.flipped]="isFlipped()">
  
  <div class="product-card card-front" (click)="flipCard()">
    <div class="product-image-container">
      <img *ngIf="veiculo.imagens && veiculo.imagens.length > 0" [src]="veiculo.imagens[0]" [alt]="veiculo.titulo">
      <div *ngIf="!veiculo.imagens || veiculo.imagens.length === 0" class="product-image-placeholder">
        {{ veiculo.categoria?.nome || 'Ve√≠culo' }}
      </div>
    </div>
    <h3>{{ veiculo.titulo }}</h3>
    <p class="price">{{ veiculo.getPrecoFormatado() }}</p>
    <div class="cta-button-container">
      <ng-container *ngIf="authService.authState().role === 'client'; else interestButton">
        <app-default-button text="Solicitar Compra" (click)="onPurchaseClick($event)"></app-default-button>
      </ng-container>
      <ng-template #interestButton>
        <app-default-button
          text="Tenho Interesse"
          [routerLink]="['/contato']"
          [queryParams]="{ veiculo: veiculo.titulo }"
          (click)="$event.stopPropagation()">
        </app-default-button>
      </ng-template>
    </div>
    <div class="flip-indicator">
      Clique para ver mais
    </div>
  </div>

  <div class="product-card card-back" (click)="flipCard()">
    <div class="back-header">
      <h4>Detalhes</h4>
    </div>
    <ul class="details-list">
      <li><strong>Ano: </strong> {{ veiculo.getAnoFormatado() }}</li>
      <li><strong>KM: </strong> {{ veiculo.quilometragem | number }} km</li>
      <li><strong>Cor: </strong> {{ veiculo.cor }}</li>
      <li><strong>Marca: </strong> {{ veiculo.marca }}</li>
      <li><strong>Modelo: </strong> {{ veiculo.modelo }}</li>
    </ul>
    <div class="cta-button-container">
      <ng-container *ngIf="authService.authState().role === 'client'; else interestButtonBack">
        <app-default-button text="Solicitar Compra" (click)="onPurchaseClick($event)"></app-default-button>
      </ng-container>
      <ng-template #interestButtonBack>
        <app-default-button
          text="Tenho Interesse"
          [routerLink]="['/contato']"
          [queryParams]="{ veiculo: veiculo.titulo }"
          (click)="$event.stopPropagation()">
        </app-default-button>
      </ng-template>
    </div>
  </div>

</div>
