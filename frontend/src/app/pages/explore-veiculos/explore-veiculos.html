<div class="explore-container">
  <app-section-header title="Nossos Veículos"></app-section-header>

  <section class="filters-block">

    <div class="filters-desktop">
      <input type="text" placeholder="Busque por nome..." class="filter-input" [ngModel]="filterChanges$.getValue().nome" (ngModelChange)="onFilterChange('nome', $event)" />

      <select class="filter-select" [ngModel]="filterChanges$.getValue().marca" (ngModelChange)="onFilterChange('marca', $event)">
        <option [ngValue]="null">Marca</option>
        <option *ngFor="let marca of marcas$ | async" [value]="marca">{{ marca }}</option>
      </select>

      <select class="filter-select" [ngModel]="filterChanges$.getValue().ano" (ngModelChange)="onFilterChange('ano', $event)">
        <option [ngValue]="null">Ano</option>
        <option *ngFor="let ano of anos$ | async" [value]="ano">{{ ano }}</option>
      </select>
      
      <div class="price-filter-group">
        <input type="number" placeholder="Preço Mín." class="filter-input" [ngModel]="filterChanges$.getValue().precoMin" (ngModelChange)="onFilterChange('precoMin', $event)" />
        <input type="number" placeholder="Preço Máx." class="filter-input" [ngModel]="filterChanges$.getValue().precoMax" (ngModelChange)="onFilterChange('precoMax', $event)" />
      </div>

    </div>

    <button class="filters-mobile-toggle" (click)="toggleFilters()">Filtrar e Ordenar</button>
  </section>

  <section class="vehicle-grid">
    <app-card-product *ngFor="let veiculo of filteredVeiculos$ | async"
      [veiculo]="veiculo" (purchaseRequest)="handlePurchaseRequest($event)" />
  </section>

  <section class="pagination-section">
    <button class="load-more-button">Carregar Mais Veículos</button>
  </section>

</div>

<div class="filters-mobile-drawer" [ngClass]="{ 'open': isFilterOpen() }">
  <div class="drawer-header">
    <h3>Filtrar e Ordenar</h3>
    <button class="close-button" (click)="toggleFilters()">X</button>
  </div>
  
  <div class="drawer-content">
    <input type="text" placeholder="Busque por nome..." class="filter-input" [ngModel]="filterChanges$.getValue().nome" (ngModelChange)="onFilterChange('nome', $event)" />
    
    <select class="filter-select" [ngModel]="filterChanges$.getValue().marca" (ngModelChange)="onFilterChange('marca', $event)">
      <option [ngValue]="null">Marca</option>
      <option *ngFor="let marca of marcas$ | async" [value]="marca">{{ marca }}</option>
    </select>
    
    <select class="filter-select" [ngModel]="filterChanges$.getValue().ano" (ngModelChange)="onFilterChange('ano', $event)">
      <option [ngValue]="null">Ano</option>
      <option *ngFor="let ano of anos$ | async" [value]="ano">{{ ano }}</option>
    </select>
    
    <input type="number" placeholder="Preço Mín." class="filter-input" [ngModel]="filterChanges$.getValue().precoMin" (ngModelChange)="onFilterChange('precoMin', $event)" />
    <input type="number" placeholder="Preço Máx." class="filter-input" [ngModel]="filterChanges$.getValue().precoMax" (ngModelChange)="onFilterChange('precoMax', $event)" />

  </div>
</div>
